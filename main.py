#!/usr/bin/env python3
\"\"\"Entry point for SecureMySite security analyzer.\"\"\"

import sys
import argparse
import logging
from pathlib import Path

from app import Application, setup_logging


def create_parser() -> argparse.ArgumentParser:
    \"\"\"Create command line argument parser.\"\"\"\n    parser = argparse.ArgumentParser(\n        prog='securemysite',\n        description='Secure My Site - Local security analyzer for AI-generated web projects',\n        formatter_class=argparse.RawDescriptionHelpFormatter,\n        epilog=\"\"\"\nExamples:\n  %(prog)s                          Launch GUI mode\n  %(prog)s /path/to/project         Scan project in CLI mode\n  %(prog)s /path/to/project --url http://localhost:8000\n                                    Scan with web analysis\n  %(prog)s /path/to/project --export json --output report.json\n                                    Export results to JSON\n  %(prog)s /path/to/project --prompt\n                                    Generate AI fix prompt\n        \"\"\"\n    )\n    \n    parser.add_argument(\n        'project_path',\n        nargs='?',\n        type=Path,\n        help='Path to project directory to scan'\n    )\n    \n    parser.add_argument(\n        '--url', '-u',\n        type=str,\n        metavar='URL',\n        help='Local URL for web scanning (e.g., http://localhost:8000)'\n    )\n    \n    parser.add_argument(\n        '--export', '-e',\n        choices=['json', 'html', 'markdown'],\n        metavar='FORMAT',\n        help='Export format for results'\n    )\n    \n    parser.add_argument(\n        '--output', '-o',\n        type=Path,\n        metavar='PATH',\n        help='Output file path for export'\n    )\n    \n    parser.add_argument(\n        '--prompt', '-p',\n        action='store_true',\n        help='Generate AI fix prompt'\n    )\n    \n    parser.add_argument(\n        '--verbose', '-v',\n        action='store_true',\n        help='Enable verbose logging'\n    )\n    \n    parser.add_argument(\n        '--version',\n        action='version',\n        version='%(prog)s 1.0.0'\n    )\n    \n    return parser\n\n\ndef validate_args(args: argparse.Namespace) -> bool:\n    \"\"\"Validate command line arguments.\"\"\"\n    # If project path provided, validate it\n    if args.project_path:\n        if not args.project_path.exists():\n            print(f\"Error: Project path does not exist: {args.project_path}\", file=sys.stderr)\n            return False\n        \n        if not args.project_path.is_dir():\n            print(f\"Error: Project path is not a directory: {args.project_path}\", file=sys.stderr)\n            return False\n    \n    # Validate URL if provided\n    if args.url:\n        from utils.validators import validate_url\n        is_valid, error = validate_url(args.url)\n        if not is_valid:\n            print(f\"Error: {error}\", file=sys.stderr)\n            return False\n    \n    # Validate export arguments\n    if args.export and not args.output:\n        print(\"Error: --output required when using --export\", file=sys.stderr)\n        return False\n    \n    return True\n\n\ndef main() -> int:\n    \"\"\"Main entry point.\"\"\"\n    parser = create_parser()\n    args = parser.parse_args()\n    \n    # Setup logging\n    setup_logging(verbose=args.verbose)\n    logger = logging.getLogger(__name__)\n    \n    logger.debug(f\"Arguments: {args}\")\n    \n    # Validate arguments\n    if not validate_args(args):\n        return 1\n    \n    # Create application\n    app = Application()\n    \n    # Determine mode\n    if args.project_path:\n        # CLI mode\n        return app.run_cli(\n            project_path=args.project_path,\n            url=args.url,\n            export_format=args.export,\n            export_path=args.output,\n            generate_prompt=args.prompt\n        )\n    else:\n        # GUI mode\n        return app.run_gui()\n\n\nif __name__ == '__main__':\n    sys.exit(main())
